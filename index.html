<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Image Color Filter Application</title>
  <style>
    * {
      box-sizing: border-box;
      font-family: 'Poppins', sans-serif;
    }

    body {
      background: #f3f4f6;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      padding: 20px;
    }

    h1 {
      color: #333;
      margin-bottom: 15px;
    }

    .container {
      background: white;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      max-width: 500px;
      width: 100%;
      text-align: center;
    }

    img {
      max-width: 100%;
      height: auto;
      margin-top: 10px;
      border-radius: 10px;
      transition: 0.3s ease all;
    }

    input[type="file"] {
      margin-bottom: 10px;
    }

    .buttons {
      margin-top: 15px;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
    }

    button {
      padding: 10px 15px;
      border: none;
      background-color: #4a90e2;
      color: white;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.3s;
    }

    button:hover {
      background-color: #357abd;
    }

    .rgb-controls {
      margin-top: 10px;
      display: none;
      flex-direction: column;
      gap: 8px;
      text-align: left;
    }

    .rgb-controls label {
      font-size: 14px;
      color: #444;
    }

    input[type="range"] {
      width: 100%;
    }
  </style>
</head>
<body>
  <h1>ðŸŽ¨ Image Color Filter App</h1>
  <div class="container">
    <input type="file" id="upload" accept="image/*"><br>
    <img id="image" src="" alt="Upload an image to begin" style="display:none;">

    <div class="buttons">
      <button onclick="applyFilter('grayscale')">Grayscale</button>
      <button onclick="applyFilter('sepia')">Sepia</button>
      <button onclick="applyFilter('invert')">Invert</button>
      <button onclick="showRGB()">Custom RGB</button>
      <button onclick="resetImage()">Reset</button>
      <button onclick="downloadImage()">Download</button>
    </div>

    <div class="rgb-controls" id="rgbControls">
      <label>Red: <input type="range" id="red" min="0" max="200" value="100"></label>
      <label>Green: <input type="range" id="green" min="0" max="200" value="100"></label>
      <label>Blue: <input type="range" id="blue" min="0" max="200" value="100"></label>
      <button onclick="applyRGB()">Apply RGB</button>
    </div>
  </div>

  <script>
    const upload = document.getElementById("upload");
    const image = document.getElementById("image");
    const rgbControls = document.getElementById("rgbControls");
    let originalSrc = "";

    // Upload and display image
    upload.addEventListener("change", () => {
      const file = upload.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = () => {
          image.src = reader.result;
          image.style.display = "block";
          originalSrc = reader.result;
          resetFilters();
        };
        reader.readAsDataURL(file);
      }
    });

    // Apply preset filters
    function applyFilter(type) {
      rgbControls.style.display = "none";
      if (type === "grayscale") image.style.filter = "grayscale(100%)";
      else if (type === "sepia") image.style.filter = "sepia(100%)";
      else if (type === "invert") image.style.filter = "invert(100%)";
    }

    // Show RGB sliders
    function showRGB() {
      rgbControls.style.display = "flex";
      resetFilters();
    }

    // Apply custom RGB filter
    function applyRGB() {
      const r = document.getElementById("red").value;
      const g = document.getElementById("green").value;
      const b = document.getElementById("blue").value;
      const avg = (parseInt(r) + parseInt(g) + parseInt(b)) / 3;
      image.style.filter = `brightness(${avg}%)`;
    }

    // Reset to original
    function resetImage() {
      image.src = originalSrc;
      resetFilters();
    }

    // Clear filters
    function resetFilters() {
      image.style.filter = "none";
      rgbControls.style.display = "none";
      document.getElementById("red").value = 100;
      document.getElementById("green").value = 100;
      document.getElementById("blue").value = 100;
    }

    // Download filtered image
    function downloadImage() {
      if (!image.src) {
        alert("Please upload an image first!");
        return;
      }

      const canvas = document.createElement("canvas");
      const ctx = canvas.getContext("2d");
      const img = new Image();

      img.crossOrigin = "anonymous";
      img.src = image.src;

      img.onload = function() {
        canvas.width = img.width;
        canvas.height = img.height;

        // Apply the current CSS filter to the canvas
        ctx.filter = getComputedStyle(image).filter;
        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

        // Create download link
        const link = document.createElement("a");
        link.download = "filtered-image.png";
        link.href = canvas.toDataURL("image/png");
        link.click();
      };
    }
  </script>
</body>
</html>
